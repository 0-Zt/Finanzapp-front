<div class="rounded-xl border border-slate-200/70 bg-white/50 p-4 dark:border-slate-700/50 dark:bg-slate-800/50">
  <div class="flex items-start justify-between gap-3">
    <div class="flex items-center gap-3">
      <div
        class="flex h-10 w-10 items-center justify-center rounded-xl"
        [style.backgroundColor]="budget.category_color + '20'"
      >
        <app-category-icon
          [icon]="budget.category_icon"
          [size]="18"
          [ariaLabel]="budget.category_name"
          [style.color]="budget.category_color"
        ></app-category-icon>
      </div>
      <div>
        <h4 class="font-medium text-slate-900 dark:text-white">{{ budget.category_name }}</h4>
        <p class="text-xs text-slate-500 dark:text-slate-400">
          {{ formatCurrency(budget.spent_amount) }} de {{ formatCurrency(budget.effective_budget_amount) }}
          @if (budget.rollover_amount > 0) {
            <span class="ml-1 text-[11px] text-slate-400 dark:text-slate-500">
              (rollover {{ formatCurrency(budget.rollover_amount) }})
            </span>
          }
        </p>
        @if (budget.suggested_budget) {
          <p class="text-[11px] text-slate-400 dark:text-slate-500">
            Sugerido: {{ formatCurrency(budget.suggested_budget) }}
          </p>
        }
      </div>
    </div>
    <span
      class="rounded-full px-2.5 py-0.5 text-xs font-medium"
      [ngClass]="statusBadgeClasses"
    >
      {{ statusLabel }}
    </span>
  </div>

  <div class="mt-3">
    <div class="h-2 w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700">
      <div
        class="h-full rounded-full transition-all duration-500"
        [ngClass]="statusClasses"
        [style.width]="progressWidth"
      ></div>
    </div>
    <div class="mt-1.5 flex items-center justify-between text-xs">
      <span class="text-slate-500 dark:text-slate-400">{{ budget.percentage.toFixed(0) }}%</span>
      <span
        class="font-medium"
        [ngClass]="{
          'text-rose-600 dark:text-rose-400': budget.remaining_amount < 0,
          'text-slate-600 dark:text-slate-300': budget.remaining_amount >= 0
        }"
      >
        @if (budget.remaining_amount >= 0) {
          Disponible: {{ formatCurrency(budget.remaining_amount) }}
        } @else {
          Excedido: {{ formatCurrency(exceededAmount) }}
        }
      </span>
    </div>
  </div>
</div>
