<article class="glass-card">
  <header class="flex flex-wrap items-start justify-between gap-6">
    <div>
      <h2 class="text-xl font-semibold text-slate-900 dark:text-white">{{ title }}</h2>
      <p class="mt-1 text-sm text-slate-600 dark:text-slate-300">
        {{ description }}
      </p>
    </div>
    <button type="button" class="quiet-button">
      {{ actionLabel }}
    </button>
  </header>

  @if (showFilters) {
    <div class="mt-6 rounded-2xl border border-slate-200/70 bg-white/70 p-4 dark:border-slate-800/70 dark:bg-slate-900/40">
      <div class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
        <input
          type="search"
          class="input-field sm:col-span-2 lg:col-span-3"
          placeholder="Buscar por descripcion"
          [ngModel]="filters.search"
          (ngModelChange)="onSearchChange($event)"
        />
        <select
          class="select-field"
          [ngModel]="filters.categoryId"
          (ngModelChange)="onCategoryChange($event)"
        >
          <option [ngValue]="'all'">Todas las categorias</option>
          @for (category of categories; track category.id) {
            <option [ngValue]="category.id">{{ category.name }}</option>
          }
        </select>
        <select
          class="select-field"
          [ngModel]="filters.type"
          (ngModelChange)="onTypeChange($event)"
        >
          <option [ngValue]="'all'">Todos</option>
          <option [ngValue]="'expense'">Gastos</option>
          <option [ngValue]="'income'">Ingresos</option>
        </select>
        <select
          class="select-field"
          [ngModel]="filters.status"
          (ngModelChange)="onStatusChange($event)"
        >
          <option [ngValue]="'all'">Estado</option>
          <option [ngValue]="'completed'">Completado</option>
          <option [ngValue]="'pending'">Pendiente</option>
        </select>
        <select
          class="select-field sm:col-span-2 lg:col-span-3"
          [ngModel]="filters.month"
          (ngModelChange)="onMonthChange($event)"
        >
          <option [ngValue]="'all'">Todos los meses</option>
          @for (month of monthOptions; track month.value) {
            <option [ngValue]="month.value">{{ month.label }}</option>
          }
        </select>
      </div>
    </div>
  }

  @if (!transactions.length) {
    <div class="mt-6 rounded-2xl border border-dashed border-slate-200/70 bg-white/70 px-5 py-6 text-sm text-slate-500 dark:border-slate-800/70 dark:bg-slate-900/40 dark:text-slate-300">
      No hay movimientos con estos filtros.
    </div>
  } @else {
    <ul class="mt-6 flex flex-col gap-5">
      @for (transaction of transactions; track transaction.id; let i = $index) {
        <li
          class="list-card flex flex-wrap items-center justify-between gap-4 animate-fade-up"
          [style.animation-delay.ms]="i * 60"
        >
          <div class="flex flex-col gap-1">
            <span class="text-base font-semibold text-slate-900 dark:text-white">
              {{ transaction.title }}
            </span>
            <span class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400">
              {{ transaction.date }} - {{ transaction.account }}
            </span>
          </div>
          <div class="flex flex-wrap items-center gap-3">
            @if (transaction.categoryColor) {
              <span
                class="badge-soft border flex items-center gap-1.5"
                [ngStyle]="categoryStyle(transaction)"
              >
                @if (transaction.categoryIcon) {
                  <app-category-icon
                    [icon]="transaction.categoryIcon"
                    [size]="14"
                    [ariaLabel]="transaction.category"
                  ></app-category-icon>
                } @else {
                  <span
                    class="h-1.5 w-1.5 rounded-full"
                    [ngStyle]="{ backgroundColor: transaction.categoryColor }"
                  ></span>
                }
                {{ transaction.category }}
              </span>
            } @else {
              <span
                class="rounded-full px-3 py-1 text-xs font-semibold flex items-center gap-1.5"
                [ngClass]="categoryClass(transaction.category)"
              >
                @if (transaction.categoryIcon) {
                  <app-category-icon
                    [icon]="transaction.categoryIcon"
                    [size]="14"
                    [ariaLabel]="transaction.category"
                  ></app-category-icon>
                }
                {{ transaction.category }}
              </span>
            }
            <span
              class="text-base font-semibold"
              [ngClass]="amountClass(transaction.type)"
            >
              {{ transaction.amount }}
            </span>
            <div class="flex items-center gap-2 text-xs font-semibold text-slate-500 dark:text-slate-400">
              <button type="button" class="hover:text-brand-600" (click)="editTransaction.emit(transaction)">
                Editar
              </button>
              <span class="text-slate-300 dark:text-slate-700">|</span>
              <button type="button" class="text-rose-500 hover:text-rose-400" (click)="deleteTransaction.emit(transaction)">
                Eliminar
              </button>
            </div>
          </div>
        </li>
      }
    </ul>
  }

  @if (hasMore) {
    <div class="mt-6 flex justify-center">
      <button type="button" class="quiet-button" (click)="loadMore.emit()">Ver m√°s</button>
    </div>
  }
</article>
